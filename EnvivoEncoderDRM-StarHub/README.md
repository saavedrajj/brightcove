## ooyala-remote-drm

This sample script creates a Live RemoteAsset in Ooyala Backlot
and requests sample keys for HLS Fairplay and DASH Common Encryption.

Create a file called `config.json` in the root directory with following json data:

```
{
    "api_key": "API Key from Backlot",
    "api_secret": "API Secret from Backlot",
    "key_server": "keyserver.ooyala.com",
    "wv_aes_key": "Widevine Key provided by OTS team",
    "wv_aes_iv": "Widevine IV provided by OTS team",
    "wv_provider_id": "PCODE of the provider"
}
```

Running the script:

Generate keys only in production
```
ruby main.rb --embed-code EMBED_CODE
```

Create new remote asset and generate keys in production
```
ruby main.rb --name RemoteAssetName
```

Pass in dash or hls urls if you need to create/update movie urls for asset
```
ruby main.rb --name RemoteAssetName --hls https://ooyala.m3u8 --dash https://ooyala.mpd
```

Display options
```
ruby main.rb --h
```

If you want to use this tool for assets in staging, pass in environment argument when calling tool
```
ruby main.rb --embed-code EMBED_CODE --environment staging
```


Sample Output generated by creating new remote asset:

```
Created a movie in Backlot with embed_code huOGVuYjE652t9CQx_qAblpmZMuPzX8S
Keys to use for HLS Fairplay: {"drm_type"=>"fps", "fps_content_key"=>"BoFl+gtAGNycBBWuUcjxGw==", "fps_content_key_iv"=>"iZzca9d3hI8+heXtB8pIYA==", :skd=>"skd://huOGVuYjE652t9CQx_qAblpmZMuPzX8S|1", :key_format=>"com.apple.streamingkeydelivery"}
Keys to use for DASH CENC: {:key=>"XAa0dgDF07IzgBf4oFYacQ==", :key_id=>"HX798fqtW1O5h3EdAA4/cQ==", :key_guid=>"f1fd7e1d-adfa-535b-b987-711d000e3f71"}
Encoded URLs added to the movie
```