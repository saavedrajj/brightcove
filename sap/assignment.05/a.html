<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script type="text/javascript" lang="javascript" src="https://cdns.gigya.com/js/gigya.js?apikey=3_mK2cmEzLkzhqe4MUrtPncxbv4wKsYAhsew0iVwhVUls3c_Jx_HLX434jAVpq5M_W"></script>
    <script>
    window.onload = function(){
        gigya.socialize.addEventHandlers({
            onLogin: onLoginHandler
        });
        function onLoginHandler(eventObj) {
            console.log("User login");
            var userEmail = eventObj.user.email;
            var userNickname = eventObj.user.email;
            var userLoginProvider = eventObj.user.loginProvider;
/*
            if (typeof userEmail !== 'undefined') { 
                loginRedirect();
            }
            else {
                var checkUserEmail = prompt("Please enter your email:", "");
                if (checkUserEmail != null) {
                    loginRedirect();
                }
            }
*/
            loginRedirect();
            function loginRedirect() {   
                window.setTimeout( function(){
                    window.location = 'b.html?nickname=' + userNickname + '&loginProvider=' + userLoginProvider;
                }, 1000);               
            }
        }
    }
</script>

</head>
<body>
    <div class="container">
    <h4>Please sign in using one of the following providers:</h4>
    <div id="loginContainer"></div>
    <script type="text/javascript">
        gigya.socialize.showLoginUI({
            showTermsLink: false, 
            buttonsStyle: "fullLogo", 
            containerID: "loginContainer",
            enabledProviders: "facebook, instagram"
        });
    </script>
            <!-- YOUR MISSION:
                Run these pages with your favorite web server.
                
                Tip: call up the page using localhost as the domain (this will allow the Gigya API key to work properly):
                http://localhost/.../a.html
                
                X 1) Add the Gigya login component showLoginUI within a container
                X 2) After authentication, redirect to b.html
                X 3) Bonus points: from the authentication response, if email is not
                   present in the User object, prompt the user to enter an email, then
                   redirect to b.html (no need to persist email, just ask for it)
                   (hint: you will need to use addEventHandlers for the onLogin event)
                  https://developers.gigya.com/display/GD/Social+Login#SocialLogin-InitiatetheLoginPlugin

                4) Bonus-bonus points: show some kind of counter or flag indicating how
                   many times the user has logged in (e.g., use a cookie or database).
                   (You can use whatever server-side or client-side implementation you want)
                   http://www.javascriptkit.com/script/script2/visitorinfo.shtml
               -->  
     </div>            
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>